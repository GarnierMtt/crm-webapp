{% extends 'base.html.twig' %}

{% block title %} - Adresse{% endblock %}


{% block path %}
    <a href="{{ path('app_societe_index') }}">Sociétés/</a>
    <a href="{{ path('app_societe_show', {'id': adresse.societe.id}) }}">{{ adresse.societe }}/</a>
    <a href="{{ path('app_adresse_show', {'id': adresse.id}) }}">{{ adresse.nomSite }}</a>
{% endblock %}
{% block content %}

    <div class="spacedLine">
        <a class="btn" href="{{ path('app_adresse_edit', {'id': adresse.id}) }}">edit</a>
        {{ include('adresse/_delete_form.html.twig') }}
    </div>
    <div style="display: flex; justify-content: space-evenly;">

        <div>
            <a class="btn ui-popupBtn" asoc="#menueContactSites">ajouter contact</a>
            <h2>Adresse :</h2>
            <table class="table">
                
                <tbody>
                        <tr>
                            <th>Nom du site</th>
                            <td>{{ adresse.nomSite }}</td>
                        </tr>
                        <tr>
                            <th>Societe</th>
                            <td>{{ adresse.societe }}</td>
                        </tr>
                        <tr>
                            <th>Adresse</th>
                            <td>
                                {{ adresse.numeroVoie }} {{ adresse.nomVoie }},<br>
                                {{ adresse.codePostal }} {{ adresse.commune }}, {{ adresse.pays }}
                            </td>
                        </tr>
                </tbody>
            </table>
        </div>

        <div>
            <h2> Contacts associés : </h2>

            <table style="margin-top: 10px;" class="table objTable"> <!-- liste contacts -->
                <tr>
                    <th colspan="2">
                        <span>contacts</span>
                    </th>
                </tr>
                {% for relation in adresse.contacts %}
                    <tr class="collapsible" onclick="colaps(this)">
                        <td>{{ relation }}</td>
                        <td>{{ relation.contact }}</td>
                    </tr>
                    <tr class="collContent">
                        <td colspan="2">
                            <div>
                                <div class="spacedLine">
                                    <span>infos :</span>
                                    <a class="btn" href="{{ path('app_relation_contact_adresse_edit', {'id': relation.id, 'msg': 'Modifier la relation entre ' ~ relation.contact ~ ' et ' ~ adresse.nomSite}) }}" target="_blank">modifier</a>
                                </div>
                                <ul>
                                    tél: {{ relation.contact.telephone }}<br>
                                    mél: {{ relation.contact.mel }}<br>
                                    notes :
                                    <ul>
                                        {{ relation.notes }}
                                    </ul>
                                </ul>

                            </div>
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="2">aucun site associé</td>
                    </tr>
                {% endfor %}
            </table>

        </div>
    </div>
    


            <div id="menueContactSites"> <!-- popup ajt contact sur site -->
                <span>Ajout contact au site</span>
                <h2>Ajouter un contact au site {{ adresse.nom }}</h2>

                {{ form_errors(formProj) }}
                {{ form_start(formProj, {
                    'action': path('app_projet_new', {'societe': societe.id}),
                    'method': 'POST'
                }) }}
                    {{ form_row(formProj.nom) }}
                    {{ form_row(formProj.dateDeb) }}
                    {{ form_row(formProj.dateFin) }}
                    {{ form_row(formProj.description) }}
                    {{ form_row(formProj._token) }}
                    <button class="btn">Save</button>
                {{ form_end(formProj, {render_rest: false}) }}
                
            </div>

    <script>

        $(function() {
            $( [ "#menueContactSites" ] ).popup();
        })
        

    </script>
    
{% endblock %}
